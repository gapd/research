# SccsId is "%W%"######################################################################### File: makefile# # Description: DLL and C Connect test suite makefile for MacOS 8/9.##	Copyright (C) 2003-2006 Cincom Systems, Inc., Santa Clara, California,#	Georg Heeg, Dortmund Germany.  All Rights Reserved.## This file should serve as a template for compiling SharedLibraries on# the PowerMac using MPW 3.5.x. It should be compatible with the# standard MPW Build commands.## CAUTION: If your library is suppose to make many calls into the virtual#	machine, like this example here, then the optimization '-D OEUNSAFE'#	in the list of  PPCCOptions will eliminate  many security checks, and#	thus will give you a  lot more performance.#	BUT if you do so, you are responsible to guarantee proper argument types#	for all parameters passed to virtual machine functions.## Roland Wagener# Eliot Miranda########################################################################## Description of this file:#   File:       makefile#   Target1 :   cptst.so#   Sources1:   cptst.c cptstcabi.c#	Target 2:	cptst#	Sources2:	testcabi.c cptstcabi.c# CC=MrC # MPW GM 3.5 includes v4.1CC="{MPW}"Tools:MrC-5.0d3:MrC # but one can download 5.0d3 from ftp.apple.comMondoBuild	= makefile		# Make blank to avoid rebuilds when makefile is modifiedIncludes	=ObjDir		=ImportLib	= vwpmac.stub # or prbckref.lib or pmacbckref.lib#  -align byte is necessary for the struct tests!!!# -opt speed causes the compiler to crash (!!)PPCCOptions  = {Includes} -enum int # -opt speed -align byte Objects  = "{ObjDir}cptst.c.x" "{ObjDir}cptstcabi.c.x"cptst.so ÄÄ {MondoBuild} {Objects} cptst.export	PPCLink ¶		-o {Targ} ¶		{Objects} {ImportLib} ¶		-t 'shlb' ¶		-c 'HPS7' ¶		-xm s ¶		"{SharedLibraries}StdCLib_3.7" ¶		"{SharedLibraries}MathLib" ¶		"{PPCLibraries}PPCCRuntime.o" ¶		-@export cptst.export"{ObjDir}cptst.c.x" Ä {MondoBuild} cptst.c	{CC} -w 35 cptst.c -o {Targ} {PPCCOptions}"{ObjDir}cptstcabi.c.x" Ä {MondoBuild} cptstcabi.c	{CC} -w 35 cptstcabi.c -o {Targ} {PPCCOptions}"{ObjDir}testcabi.c.x" Ä {MondoBuild} testcabi.c	{CC} -w 35 testcabi.c -o {Targ} {PPCCOptions}TestObjects  = "{ObjDir}testcabi.c.x" "{ObjDir}cptstcabi.c.x"cptst ÄÄ {MondoBuild} {TestObjects}	PPCLink -o {Targ} -t APPL -c 'MPW' -xm e ¶		{TestObjects} ¶		"{SharedLibraries}StdCLib_3.7" ¶		"{PPCLibraries}"StdCRuntime.o ¶		"{SharedLibraries}MathLib" ¶		"{PPCLibraries}PPCCRuntime.o"		# The following script generates a file containing all exported procedure names,# one for each line, as needed for linking a shared lib.# The pattern is supposed to be "start of line" [Option-8], literal period [Option-d .],# 0-tagged any number of characters [( ? * ) Option-R 0], literal {PR} [Option-d { P R Option-d }]# and the replacement is supposed to be the 0-tagged expression [Option-R 0]cptst.export Ä 	{MondoBuild} "{ObjDir}cptst.c.x" "{ObjDir}cptstcabi.c.x"	DumpXCOFF -n Funct "{ObjDir}cptst.c.x" "{ObjDir}cptstcabi.c.x" ¶	| Search '{PR}' ¶	| StreamEdit -e '/¥¶.?*¶{PR¶}/ Replace /¥¶.(?*)¨0¶{PR¶}/ ¨0' ¶	>{Targ}